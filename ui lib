
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")

local PlayerListFrame = Instance.new("Frame")
PlayerListFrame.Size = UDim2.new(0, 300, 0, 250)
PlayerListFrame.Position = UDim2.new(0.02, 0, 0.1, 0) -- Moved higher
PlayerListFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
PlayerListFrame.BorderSizePixel = 3
PlayerListFrame.Visible = false
PlayerListFrame.Parent = game.CoreGui
PlayerListFrame.Draggable = true

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 8)
corner.Parent = PlayerListFrame

local glow = Instance.new("UIStroke")
glow.Thickness = 2
glow.Color = Color3.fromRGB(0, 255, 0)
glow.Parent = PlayerListFrame

-- Scrollable Area for the player list
local playerListContainer = Instance.new("ScrollingFrame")
playerListContainer.Size = UDim2.new(1, 0, 1, 0)
playerListContainer.CanvasSize = UDim2.new(0, 0, 10, 0)
playerListContainer.ScrollBarThickness = 5
playerListContainer.BackgroundTransparency = 1
playerListContainer.Parent = PlayerListFrame

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Parent = playerListContainer

-- Function to create action buttons next to a player's name
local function createButtonsForPlayer(playerButton, playerName)
    -- Create a frame next to the player's name for buttons
    local buttonFrame = Instance.new("Frame")
    buttonFrame.Size = UDim2.new(0, 90, 0, 40)
    buttonFrame.Position = UDim2.new(1, 5, 0, 0) -- Right next to the name
    buttonFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    buttonFrame.Visible = false
    buttonFrame.Parent = playerButton

    local function createActionButton(name, position, callback)
        local button = Instance.new("TextButton")
        button.Size = UDim2.new(0.5, -5, 1, 0)
        button.Position = position
        button.Text = name
        button.Font = Enum.Font.Gotham
        button.TextSize = 12
        button.TextColor3 = Color3.fromRGB(255, 255, 255)
        button.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
        button.Parent = buttonFrame
        button.MouseButton1Click:Connect(callback)
        return button
    end

    -- Add two action buttons
    local kickButton = createActionButton("Kick", UDim2.new(0, 0, 0, 0), function()
        print("Kick " .. playerName)
    end)

    local messageButton = createActionButton("Msg", UDim2.new(0.5, 5, 0, 0), function()
        print("Message " .. playerName)
    end)

    -- Show buttons when clicking player name
    playerButton.MouseButton1Click:Connect(function()
        buttonFrame.Visible = not buttonFrame.Visible
    end)
end

-- Function to update the player list dynamically
local function updatePlayerList()
    for _, v in pairs(playerListContainer:GetChildren()) do
        if v:IsA("Frame") or v:IsA("TextButton") then
            v:Destroy()
        end
    end
    
    for _, player in pairs(Players:GetPlayers()) do
        local playerRow = Instance.new("Frame")
        playerRow.Size = UDim2.new(1, -100, 0, 40)
        playerRow.BackgroundTransparency = 1
        playerRow.Parent = playerListContainer

        local playerButton = Instance.new("TextButton")
        playerButton.Size = UDim2.new(1, 0, 1, 0)
        playerButton.Text = player.Name
        playerButton.Font = Enum.Font.Gotham
        playerButton.TextSize = 14
        playerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        playerButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        playerButton.Parent = playerRow

        createButtonsForPlayer(playerButton, player.Name)
    end
end

-- Update list when players join/leave
Players.PlayerAdded:Connect(updatePlayerList)
Players.PlayerRemoving:Connect(updatePlayerList)



    PlayerListFrame.Visible = not PlayerListFrame.Visible
    if PlayerListFrame.Visible then
        updatePlayerList()
    end


-- Movement using Numpad 1 and 2
local moveSpeed = 0.05
local function onInputBegan(input, gameProcessed)
    if gameProcessed then return end

    if input.KeyCode == Enum.KeyCode.KeypadOne then
        PlayerListFrame.Position = UDim2.new(PlayerListFrame.Position.X.Scale - moveSpeed, 0, PlayerListFrame.Position.Y.Scale, 0)
    elseif input.KeyCode == Enum.KeyCode.KeypadTwo then
        PlayerListFrame.Position = UDim2.new(PlayerListFrame.Position.X.Scale + moveSpeed, 0, PlayerListFrame.Position.Y.Scale, 0)
    end
end

UserInputService.InputBegan:Connect(onInputBegan)
